<html><head>
    <style>
        @import url("https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700");
    </style>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"> 
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>
    <div id="fpecanvas" style="margin-top: 2em; margin-bottom: 2em; text-align: center;">
        <canvas id="bkg" width="625" height="159"></canvas><br />
        <span style="font-size: 8pt;">**Note - the font for the FPE doesn't always load right. If it looks like it loaded Times New Roman, refresh the page.**</span><br />
        <button name="download" id="download" class="btn btn-success" style="margin-top: 1em">Download</button>
    </div>
    <div id="controls" style="margin-top: 10px; margin-left: 5%; margin-right: 5%">
        <form action="javascript:void(0)">
            <div class="form-group row">
              <label class="col-3 col-form-label" for="callsign">Callsign</label> 
              <div class="col-9">
                <input id="callsign" name="callsign" placeholder="CCA981" type="text" class="form-control">
              </div>
            </div>
            <div class="form-group row">
              <label for="cid" class="col-3 col-form-label">CID</label> 
              <div class="col-9">
                <input id="cid" name="cid" placeholder="123" type="text" class="form-control">
              </div>
            </div>
            <div class="form-group row">
              <label for="squawk" class="col-3 col-form-label">Beacon Code</label> 
              <div class="col-9">
                <input id="squawk" name="squawk" placeholder="8989" type="text" class="form-control">
              </div>
            </div>
            <div class="form-group row">
              <label for="actype" class="col-3 col-form-label">Aircraft Type Code</label> 
              <div class="col-9">
                <input id="actype" name="actype" placeholder="A320" type="text" class="form-control">
              </div>
            </div>
            <div class="form-group row">
              <label for="equip" class="col-3 col-form-label">Equipment Suffix</label> 
              <div class="col-9">
                <input id="equip" name="equip" placeholder="L" type="text" class="form-control">
              </div>
            </div>
            <div class="form-group row">
              <label for="dep" class="col-3 col-form-label">Departure</label> 
              <div class="col-9">
                <input id="dep" name="dep" placeholder="KEWR" type="text" class="form-control">
              </div>
            </div>
            <div class="form-group row">
              <label for="dest" class="col-3 col-form-label">Destination</label> 
              <div class="col-9">
                <input id="dest" name="dest" placeholder="KBOS" type="text" class="form-control">
              </div>
            </div>
            <div class="form-group row">
              <label for="spd" class="col-3 col-form-label">Speed</label> 
              <div class="col-9">
                <input id="spd" name="spd" placeholder="69" type="text" class="form-control">
              </div>
            </div>
            <div class="form-group row">
              <label for="alt" class="col-3 col-form-label">Altitude</label> 
              <div class="col-9">
                <input id="alt" name="alt" placeholder="420" type="text" class="form-control">
              </div>
            </div>
            <div class="form-group row">
              <label for="route1" class="col-3 col-form-label">Route (Line 1)</label> 
              <div class="col-9">
                <input id="route1" name="route1" placeholder="TAKE OF NEWARK FLY TO BOSTON AND LAND" type="text" class="form-control">
              </div>
            </div>
            <div class="form-group row">
              <label for="route2" class="col-3 col-form-label">Route (Line 2)</label> 
              <div class="col-9">
                <input id="route2" name="route2" type="text" class="form-control">
              </div>
            </div>
            <div class="form-group row">
              <label for="rmks1" class="col-3 col-form-label">Remarks (Line 1)</label> 
              <div class="col-9">
                <input id="rmks1" name="rmks1" placeholder="NEW TO VATSIM AND THE A320 I WILL TRY MY BEST" type="text" class="form-control">
              </div>
            </div>
            <div class="form-group row">
              <label for="rmks2" class="col-3 col-form-label">Remarks (Line 2)</label> 
              <div class="col-9">
                <input id="rmks2" name="rmks2" type="text" class="form-control">
              </div>
            </div> 
            <div class="form-group row">
              <div class="offset-3 col-9">
                <button id="submit" name="submit" type="submit" class="btn btn-primary">Generate</button>
              </div>
            </div>
          </form>
    </div>
    </div>
    <script>
        function draw(callsign, cid, beacon, actype, suffix, dep, dest, spd, alt, rte1, rte2, rmk1, rmk2){
            var c = document.getElementById("bkg");
            var ctx = c.getContext("2d");
            var img = new Image();
            img.onload = () => {
                ctx.drawImage(img, 0, 0);
                //draw Callsign
                drawtxtcenter(callsign ? callsign : "", 83, 58);
                //draw CID
                drawtxtcenter(cid ? cid : "", 142, 58);
                //draw Beacon Code
                drawtxtcenter(beacon ? beacon : "", 173, 58);
                //draw Aircraft Type
                drawtxtcenter(actype ? actype : "", 238, 58);
                //draw Equipment Suffix
                drawtxtcenter(suffix ? suffix : "", 283, 58);
                //draw Departure
                drawtxtcenter(dep ? dep : "", 327, 58);
                //draw Destination
                drawtxtcenter(dest ? dest : "", 386.5, 58);
                //draw Speed
                drawtxtcenter(spd ? spd : "", 447, 58);
                //draw Altitude
                drawtxtcenter(alt ? alt : "", 514, 58);
                //draw Route Line 1
                drawtxtleft(rte1 ? rte1 : "", 43, 82);
                //draw Route Line 2
                drawtxtleft(rte2 ? rte2 : "", 43, 101);
                //draw Remarks Line 1
                drawtxtleft(rmk1 ? rmk1 : "", 43, 126);
                //draw Remarks Line 2
                drawtxtleft(rmk2 ? rmk2 : "", 43, 145);
            };
            img.src = 'CRC_FPE_Template_Blank.png';
            // img.src = 'fpe2.png';
        }

        function drawtxtcenter(txt, x, y){
            var c = document.getElementById("bkg");
            var ctx = c.getContext("2d");
            ctx.textAlign = "center"; 
            ctx.font = "300 10.5pt Ubuntu";
            ctx.fillStyle = "#7eb4ea";
            ctx.fillText(txt, x, y);
        }
        function drawtxtleft(txt, x, y){
            var c = document.getElementById("bkg");
            var ctx = c.getContext("2d");
            ctx.textAlign = "left"; 
            ctx.font = "300 10.5pt Ubuntu";
            ctx.fillStyle = "#7eb4ea";
            ctx.fillText(txt, x, y);
        }
        draw("CCA981", 432, 8989, "A320", "L", "KEWR", "KBOS", 69, 420, "TAKE OF NEWARK FLY TO BOSTON AND LAND", "", "NEW TO VATSIM AND THE A320 I WILL TRY MY BEST");

        function _showDocument(_base64Url){
            var win = window.open();
            win.document.write("<img src=\"" + _base64Url + "\"></img><br />Right click and save image as to download.");
        }

        document.getElementById("download").addEventListener('click', () => {
            const canvas = document.getElementById('bkg');
            const img    = canvas.toDataURL('image/png');
            
            _showDocument(img);
        })

        document.getElementById("submit").addEventListener('click', () => {
            callsigntext = document.getElementById("callsign").value;
            cidtext = document.getElementById("cid").value;
            squawktext = document.getElementById("squawk").value;
            actypetext = document.getElementById("actype").value;
            equiptext = document.getElementById("equip").value;
            deptext = document.getElementById("dep").value;
            desttext = document.getElementById("dest").value;
            spdtext = document.getElementById("spd").value;
            alttext = document.getElementById("alt").value;
            route1text = document.getElementById("route1").value;
            route2text = document.getElementById("route2").value;
            rmks1text = document.getElementById("rmks1").value;
            rmks2text = document.getElementById("rmks2").value;

            draw(callsigntext, cidtext, squawktext, actypetext, equiptext, deptext, desttext, spdtext, alttext, route1text, route2text, rmks1text, rmks2text);

        })
    </script> 
</body>
</html>